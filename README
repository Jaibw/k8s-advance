# INSTALL DOCKER 
wget https://raw.githubusercontent.com/Jaibw/k8s-advance/main/install-docker.sh && sh install-docker.sh

# RUN 1ST CONTAINER 
docker run hello-world 
docker run ubuntu apt update
docker run centos yum update
docker run python python --version
docker run openjdk java --help 

# LIST LOCAL IMAGES 
docker images
docker pull mysql
docker images
docker inspect mysql
docker history mysql
docker rmi mysql 


# LIST CONTAINERS 
docker ps  -a
docker run jpetazzo/clock
docker run -d jpetazzo/clock
docker run -d nginx
docker run -e MYSQL_ROOT_PASSWORD=secret  -d mysql
docker ps      #  active containers 
docker stop <container-id>   
docker stop <container-id> <container-id>  
docker ps -a   # list all the containers

docker ps       # active containers 
docker ps -a    # all containers 
docker ps -q    # ids for active conainers 
docker ps -qa   # ids for all conainers
docker ps -l    # info about last container

docker stop `docker ps -q`    # stop all the active containers 
docker rm `docker ps -qa`     # remove all the containers 

# DOCKER HUB 
https://hub.docker.com/search?type=image&image_filter=official

# TROUBLESHOOT A CONTAINER
docker run --name database -e MYSQL_ROOT_PASSWORD=secret -d mysql
docker run --name website -d nginx
docker ps 
docker logs website
docker exec -it website bash
    # curl localhost
    # exit 
docker logs database 
docker exec -it database bash
    # ls /etc/mysql 
    # cat /etc/mysql/my.cnf 
    # exit 
docker stop website database 
docker rm website database   # rm - remove containers 
docker rmi nginx mysql       # rmi - remove image 

# DOCKER ADVANCE COMMANDS 
docker system df
docker system info
docker system events   # Ctrl + c
docker system prune
docker system prune -a

docker run --name mycache -d redis 
docker run --hostname ubuntu01 -it ubuntu bash 
   # hostname 
   # exit 
docker run -e USER=DEMO -e PASS=SECRET -it ubuntu bash 
   # echo $USER
   # echo $PASS
docker top mycache
docker inspect mycache
sudo ls /var/lib/docker
docker run -it -m 300M ubuntu:14.04 /bin/bash
   # top    press q to exit 
   # exit 
docker run -it -m 500M --memory-reservation 200M ubuntu:14.04 /bin/bash
   # top    press q to exit 
   # exit
docker run -it --cpus 0.02 ubuntu:14.04 /bin/bash
   # top    press q to exit 
   # exit

docker stats             # ctrl + c

# VOLUME 
docker volume ls
docker volume create mysqldata
docker volume ls
docker inspect mysqldata
sudo ls /var/lib/docker/volumes/mysqldata/_data
docker run --name database -v mysqldata:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=secret -d mysql
docker stop database
docker rm database
sudo ls /var/lib/docker/volumes/mysqldata/_data

# PORT BINDING AND VOLUME MAPPING 
cd ~
git clone https://github.com/Jaibw/FrozenYogurtShop.git
ls FrozenYogurtShop/
docker run -v /home/ubuntu/FrozenYogurtShop:/usr/share/nginx/html -p 80:80 --name website-01 -d nginx
docker ps
Open chrome - http://<public-ip>

# SEARCH AN IMAGE 
docker search nginx
Visit https://hub.docker.com/_/nginx 

# CREATE AN IMAGE FROM CONTAINER 
docker run --name myubuntu -it ubuntu bash
    # apt update 
    # apt install -y nginx vim curl 
    # service nginx start  
    # curl localhost  
    # vim                   type :q to exit 
docker commit myubuntu myubuntu:1 
docker history myubuntu:1
docker inspect myubuntu:1
docker run -it myubuntu:1 bash
    # nginx 
    # vim                  type :q to exit 

# CREATE AN IMAGE USING Dockerfile 
mkdir ~/myubuntu
cd ~/myubuntu
wget -O Dockerfile https://raw.githubusercontent.com/Jaibw/k8s-advance/main/Dockerfile-demo
docker build -t myubuntu:2 .
docker history myubuntu:2
docker inspect myubuntu:2
docker run -it myubuntu:2 bash
   # nginx 
   # vim                  type :q to exit  

# DOCKER COMPOSE 
cd ~
git clone https://github.com/Jaibw/FrozenYogurtShop.git website01
cd website01
cat docker-compose.yml
docker-compose up
Open chrome - http://<public-ip>
